<?xml version="1.0" encoding="UTF-8"?>
    <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                    xmlns:nvd="http://scap.nist.gov/schema/feed/vulnerability/2.0"
		    xmlns:cvss="http://scap.nist.gov/schema/cvss-v2/0.2"
                    xmlns:vuln="http://scap.nist.gov/schema/vulnerability/0.4" version="1.0">

    <xsl:output encoding="UTF-8" method="text" />

    <xsl:template match="/"><xsl:apply-templates select="nvd:nvd" /></xsl:template>

    <xsl:template match="nvd:nvd"><xsl:apply-templates select="nvd:entry" /></xsl:template>

    <xsl:template match="nvd:entry">
    <xsl:apply-templates select="vuln:vulnerable-software-list">
      <xsl:with-param name="entryid" select="@id" />
      <xsl:with-param name="score" select="vuln:cvss/cvss:base_metrics/cvss:score" />
      <xsl:with-param name="access-vector" select="vuln:cvss/cvss:base_metrics/cvss:access-vector" />
      <xsl:with-param name="access-complexity" select="vuln:cvss/cvss:base_metrics/cvss:access-complexity" />
      <xsl:with-param name="authentication" select="vuln:cvss/cvss:base_metrics/cvss:authentication" />
      <xsl:with-param name="confidentiality-impact" select="vuln:cvss/cvss:base_metrics/cvss:confidentiality-impact" />
      <xsl:with-param name="integrity-impact" select="vuln:cvss/cvss:base_metrics/cvss:integrity-impact" />
      <xsl:with-param name="availability-impact" select="vuln:cvss/cvss:base_metrics/cvss:availability-impact" />
      <xsl:with-param name="source" select="vuln:cvss/cvss:base_metrics/cvss:source" />
      <xsl:with-param name="generated-on-datetime" select="vuln:cvss/cvss:base_metrics/cvss:generated-on-datetime" />
      <xsl:with-param name="references" select="vuln:references" />
      <xsl:with-param name="summary" select="vuln:summary" />
    </xsl:apply-templates>
    </xsl:template>

    <xsl:template match="vuln:vulnerable-software-list">
    <xsl:param name="entryid" />
    <xsl:param name="score" />
    <xsl:param name="access-vector" />
    <xsl:param name="access-complexity" />
    <xsl:param name="authentication" />
    <xsl:param name="confidentiality-impact" />
    <xsl:param name="integrity-impact" />
    <xsl:param name="availability-impact" />
    <xsl:param name="source" />
    <xsl:param name="generated-on-datetime" />
    <xsl:param name="references" />
    <xsl:param name="summary" />
    <xsl:for-each select="vuln:product">
    	<xsl:value-of select="$entryid" />;<xsl:value-of select="$score" />;<xsl:value-of select="$access-vector" />;<xsl:value-of select="$access-complexity" />;<xsl:value-of select="$authentication" />;<xsl:value-of select="$confidentiality-impact" />;<xsl:value-of select="$integrity-impact" />;<xsl:value-of select="$availability-impact" />;<xsl:value-of select="$source" />;<xsl:value-of select="$generated-on-datetime" />;<xsl:value-of select="$references" />;<xsl:value-of select="$summary" /><xsl:text>
    </xsl:text>
    </xsl:for-each>
    </xsl:template>
    </xsl:stylesheet>
